<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/pom.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/pom.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#10;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;&#10;         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&#10;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;&#10;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&#10;&#10;    &lt;groupId&gt;com.youcode.digitalhospitla&lt;/groupId&gt;&#10;    &lt;artifactId&gt;DigitalHospital&lt;/artifactId&gt;&#10;    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&#10;    &lt;name&gt;DigitalHospital&lt;/name&gt;&#10;    &lt;packaging&gt;war&lt;/packaging&gt;&#10;&#10;    &lt;properties&gt;&#10;        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;&#10;        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;&#10;        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;&#10;        &lt;junit.version&gt;5.13.2&lt;/junit.version&gt;&#10;    &lt;/properties&gt;&#10;&#10;    &lt;dependencies&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;jakarta.platform&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jakarta.jakartaee-web-api&lt;/artifactId&gt;&#10;            &lt;version&gt;11.0.0&lt;/version&gt;&#10;            &lt;scope&gt;provided&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.hibernate.orm&lt;/groupId&gt;&#10;            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;&#10;            &lt;version&gt;7.0.4.Final&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.glassfish.jaxb&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jaxb-runtime&lt;/artifactId&gt;&#10;            &lt;version&gt;4.0.5&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;&#10;            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;&#10;            &lt;version&gt;9.0.1.Final&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;&#10;            &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;&#10;            &lt;version&gt;${junit.version}&lt;/version&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;&#10;            &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;&#10;            &lt;version&gt;${junit.version}&lt;/version&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;&#10;            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;&#10;            &lt;version&gt;42.7.8&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;            &lt;version&gt;1.18.42&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.jboss.weld.servlet&lt;/groupId&gt;&#10;            &lt;artifactId&gt;weld-servlet-core&lt;/artifactId&gt;&#10;            &lt;version&gt;6.0.3.Final&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;jakarta.enterprise&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jakarta.enterprise.cdi-api&lt;/artifactId&gt;&#10;            &lt;version&gt;4.1.0&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;jakarta.inject&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jakarta.inject-api&lt;/artifactId&gt;&#10;            &lt;version&gt;2.0.1&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;    &lt;/dependencies&gt;&#10;&#10;    &lt;build&gt;&#10;        &lt;plugins&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;&#10;                &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;&#10;                &lt;version&gt;3.4.0&lt;/version&gt;&#10;            &lt;/plugin&gt;&#10;        &lt;/plugins&gt;&#10;    &lt;/build&gt;&#10;&lt;/project&gt;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#10;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;&#10;         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&#10;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;&#10;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&#10;&#10;    &lt;groupId&gt;com.youcode.digitalhospitla&lt;/groupId&gt;&#10;    &lt;artifactId&gt;DigitalHospital&lt;/artifactId&gt;&#10;    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&#10;    &lt;name&gt;DigitalHospital&lt;/name&gt;&#10;    &lt;packaging&gt;war&lt;/packaging&gt;&#10;&#10;    &lt;properties&gt;&#10;        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;&#10;        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;&#10;        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;&#10;        &lt;junit.version&gt;5.13.2&lt;/junit.version&gt;&#10;    &lt;/properties&gt;&#10;&#10;    &lt;dependencies&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;jakarta.platform&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jakarta.jakartaee-web-api&lt;/artifactId&gt;&#10;            &lt;version&gt;11.0.0&lt;/version&gt;&#10;            &lt;scope&gt;provided&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.hibernate.orm&lt;/groupId&gt;&#10;            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;&#10;            &lt;version&gt;7.0.4.Final&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.glassfish.jaxb&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jaxb-runtime&lt;/artifactId&gt;&#10;            &lt;version&gt;4.0.5&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;&#10;            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;&#10;            &lt;version&gt;9.0.1.Final&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;!-- EL Dependencies for Hibernate Validator --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.glassfish.expressly&lt;/groupId&gt;&#10;            &lt;artifactId&gt;expressly&lt;/artifactId&gt;&#10;            &lt;version&gt;5.0.0&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;&#10;            &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;&#10;            &lt;version&gt;${junit.version}&lt;/version&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;&#10;            &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;&#10;            &lt;version&gt;${junit.version}&lt;/version&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;&#10;            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;&#10;            &lt;version&gt;42.7.8&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;            &lt;version&gt;1.18.42&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.jboss.weld.servlet&lt;/groupId&gt;&#10;            &lt;artifactId&gt;weld-servlet-core&lt;/artifactId&gt;&#10;            &lt;version&gt;6.0.3.Final&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;jakarta.enterprise&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jakarta.enterprise.cdi-api&lt;/artifactId&gt;&#10;            &lt;version&gt;4.1.0&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;jakarta.inject&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jakarta.inject-api&lt;/artifactId&gt;&#10;            &lt;version&gt;2.0.1&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;    &lt;/dependencies&gt;&#10;&#10;    &lt;build&gt;&#10;        &lt;plugins&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;&#10;                &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;&#10;                &lt;version&gt;3.4.0&lt;/version&gt;&#10;            &lt;/plugin&gt;&#10;        &lt;/plugins&gt;&#10;    &lt;/build&gt;&#10;&lt;/project&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/youcode/digitalhospital/Main.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/youcode/digitalhospital/Main.java" />
              <option name="originalContent" value="package com.youcode.digitalhospital;&#10;&#10;import com.youcode.digitalhospital.config.JPAConfig;&#10;import com.youcode.digitalhospital.model.*;&#10;import com.youcode.digitalhospital.repository.imp.*;&#10;import jakarta.persistence.EntityManager;&#10;import jakarta.persistence.EntityTransaction;&#10;import jakarta.persistence.Persistence;&#10;&#10;import java.time.LocalDate;&#10;import java.time.LocalDateTime;&#10;import java.util.List;&#10;&#10;public class Main {&#10;    public static void main(String[] args) {&#10;        System.out.println(&quot;==============================================&quot;);&#10;        System.out.println(&quot;Starting Repository Tests&quot;);&#10;        System.out.println(&quot;==============================================\n&quot;);&#10;&#10;        EntityManager em = null;&#10;        EntityTransaction transaction = null;&#10;&#10;        try {&#10;            // Initialize EntityManager&#10;            em = Persistence.createEntityManagerFactory(&quot;DigitalHospitalPU&quot;).createEntityManager();&#10;            System.out.println(em);&#10;            transaction = em.getTransaction();&#10;            transaction.begin();&#10;&#10;            // Initialize repositories&#10;            DepartmentRepositoryImp departmentRepo = new DepartmentRepositoryImp();&#10;            DoctorRepositoryImp doctorRepo = new DoctorRepositoryImp();&#10;            PatientRepositoryImp patientRepo = new PatientRepositoryImp();&#10;            RoomRepositoryImp roomRepo = new RoomRepositoryImp();&#10;            ConsultationSlotRepositoryImp slotRepo = new ConsultationSlotRepositoryImp();&#10;            ConsultationRepositoryImp consultationRepo = new ConsultationRepositoryImp();&#10;&#10;            // ==================== TEST 1: Department ==================== //&#10;            System.out.println(&quot;TEST 1: Creating Department...&quot;);&#10;            Department department = new Department();&#10;            department.setName(&quot;Cardiology&quot;);&#10;            department.setDescription(&quot;Heart and cardiovascular department&quot;);&#10;            em.persist(department);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Department created with ID: &quot; + department.getId());&#10;            System.out.println();&#10;&#10;            // ==================== TEST 2: Doctor ==================== //&#10;            System.out.println(&quot;TEST 2: Creating Doctor...&quot;);&#10;            Doctor doctor = new Doctor();&#10;            doctor.setFirstName(&quot;John&quot;);&#10;            doctor.setLastName(&quot;Smith&quot;);&#10;            doctor.setEmail(&quot;john.smith@hospital.com&quot;);&#10;            doctor.setPassword(&quot;password123&quot;);&#10;            doctor.setSpeciality(&quot;Cardiologist&quot;);&#10;            doctor.setDepartment(department);&#10;            em.persist(doctor);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Doctor created with ID: &quot; + doctor.getId());&#10;            System.out.println(&quot;  Name: &quot; + doctor.getUserName());&#10;            System.out.println(&quot;  Specialty: &quot; + doctor.getSpecialty());&#10;            System.out.println();&#10;&#10;            // ==================== TEST 3: Patient ==================== //&#10;            System.out.println(&quot;TEST 3: Creating Patient...&quot;);&#10;            Patient patient = new Patient();&#10;            patient.setFirstName(&quot;Jane&quot;);&#10;            patient.setLastName(&quot;Doe&quot;);&#10;            patient.setEmail(&quot;jane.doe@email.com&quot;);&#10;            patient.setPassword(&quot;patient123&quot;);&#10;            patient.setWeight(65.5);&#10;            patient.setHeight(165.0);&#10;            patient.setDateOfBirth(LocalDate.of(1990, 5, 15));&#10;            patient.setPhoneNumber(&quot;0612345678&quot;);&#10;            em.persist(patient);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Patient created with ID: &quot; + patient.getId());&#10;            System.out.println(&quot;  Name: &quot; + patient.getUserName());&#10;            System.out.println(&quot;  Weight: &quot; + patient.getWeight() + &quot; kg&quot;);&#10;            System.out.println(&quot;  Height: &quot; + patient.getHeight() + &quot; cm&quot;);&#10;            System.out.println();&#10;&#10;            // ==================== TEST 4: Room ==================== //&#10;            System.out.println(&quot;TEST 4: Creating Room...&quot;);&#10;            Room room = new Room();&#10;            room.setRoomNumber(101L);&#10;            room.setAvailable(true);&#10;            em.persist(room);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Room created with ID: &quot; + room.getId());&#10;            System.out.println(&quot;  Room Number: &quot; + room.getRoomNumber());&#10;            System.out.println(&quot;  Available: &quot; + room.isAvailable());&#10;            System.out.println();&#10;&#10;            // ==================== TEST 5: Consultation Slot ==================== //&#10;            System.out.println(&quot;TEST 5: Creating Consultation Slot...&quot;);&#10;            ConsultationSlot slot = new ConsultationSlot();&#10;            slot.setStartTime(LocalDateTime.now().plusDays(1).withHour(10).withMinute(0));&#10;            slot.setEndTime(LocalDateTime.now().plusDays(1).withHour(10).withMinute(30));&#10;            slot.setRoom(room);&#10;            slot.setCancelled(false);&#10;            em.persist(slot);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Consultation Slot created with ID: &quot; + slot.getId());&#10;            System.out.println(&quot;  Start Time: &quot; + slot.getStartTime());&#10;            System.out.println(&quot;  End Time: &quot; + slot.getEndTime());&#10;            System.out.println();&#10;&#10;            // ==================== TEST 6: Consultation ==================== //&#10;            System.out.println(&quot;TEST 6: Creating Consultation...&quot;);&#10;            Consultation consultation = new Consultation();&#10;            consultation.setPatient(patient);&#10;            consultation.setDoctor(doctor);&#10;            consultation.setSlot(slot);&#10;            consultation.setConsultationDate(LocalDate.now().plusDays(1));&#10;            consultation.setConsultationTime(slot.getStartTime());&#10;            consultation.setReason(&quot;Regular checkup&quot;);&#10;            consultation.setConsultationStatus(ConsultationStatus.RESERVED);&#10;            em.persist(consultation);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Consultation created with ID: &quot; + consultation.getId());&#10;            System.out.println(&quot;  Patient: &quot; + patient.getUserName());&#10;            System.out.println(&quot;  Doctor: &quot; + doctor.getUserName());&#10;            System.out.println(&quot;  Status: &quot; + consultation.getConsultationStatus());&#10;            System.out.println();&#10;&#10;            transaction.commit();&#10;            System.out.println(&quot;✓ All entities persisted successfully!\n&quot;);&#10;&#10;            // ==================== TEST 7: Repository Queries ==================== //&#10;            System.out.println(&quot;==============================================&quot;);&#10;            System.out.println(&quot;Testing Repository Query Methods&quot;);&#10;            System.out.println(&quot;==============================================\n&quot;);&#10;&#10;            // Test Department Repository&#10;            System.out.println(&quot;TEST 7.1: Finding Department by Name...&quot;);&#10;            Department foundDept = departmentRepo.findByName(&quot;Cardiology&quot;, em).orElse(null);&#10;            if (foundDept != null) {&#10;                System.out.println(&quot;✓ Found Department: &quot; + foundDept.getName());&#10;            }&#10;            System.out.println();&#10;&#10;            // Test Doctor Repository&#10;            System.out.println(&quot;TEST 7.2: Finding Doctors by Specialty...&quot;);&#10;            List&lt;Doctor&gt; cardiologists = doctorRepo.findBySpecialty(&quot;Cardiologist&quot;, em);&#10;            System.out.println(&quot;✓ Found &quot; + cardiologists.size() + &quot; Cardiologist(s)&quot;);&#10;            System.out.println();&#10;&#10;            // Test Patient Repository&#10;            System.out.println(&quot;TEST 7.3: Finding Patient by Email...&quot;);&#10;            Patient foundPatient = patientRepo.findByEmail(&quot;jane.doe@email.com&quot;, em);&#10;            if (foundPatient != null) {&#10;                System.out.println(&quot;✓ Found Patient: &quot; + foundPatient.getUserName());&#10;            }&#10;            System.out.println();&#10;&#10;            // Test Room Repository&#10;            System.out.println(&quot;TEST 7.4: Finding Available Rooms...&quot;);&#10;            List&lt;Room&gt; availableRooms = roomRepo.findAvailableRooms(em);&#10;            System.out.println(&quot;✓ Found &quot; + availableRooms.size() + &quot; available room(s)&quot;);&#10;            System.out.println();&#10;&#10;            // Test Slot Repository&#10;            System.out.println(&quot;TEST 7.5: Finding Available Slots...&quot;);&#10;            List&lt;ConsultationSlot&gt; availableSlots = slotRepo.findAvailableSlots(em);&#10;            System.out.println(&quot;✓ Found &quot; + availableSlots.size() + &quot; available slot(s)&quot;);&#10;            System.out.println();&#10;&#10;            // Test Consultation Repository&#10;            System.out.println(&quot;TEST 7.6: Finding Consultations by Patient...&quot;);&#10;            List&lt;Consultation&gt; patientConsultations = consultationRepo.findByPatient(patient, em);&#10;            System.out.println(&quot;✓ Found &quot; + patientConsultations.size() + &quot; consultation(s) for patient&quot;);&#10;            System.out.println();&#10;&#10;            System.out.println(&quot;TEST 7.7: Counting Consultations by Status...&quot;);&#10;            Long reservedCount = consultationRepo.countByStatus(ConsultationStatus.RESERVED, em);&#10;            System.out.println(&quot;✓ Total RESERVED consultations: &quot; + reservedCount);&#10;            System.out.println();&#10;&#10;            // Test Slot Availability&#10;            System.out.println(&quot;TEST 7.8: Checking Slot Availability...&quot;);&#10;            boolean isAvailable = slotRepo.isSlotAvailable(slot.getId(), em);&#10;            System.out.println(&quot;✓ Slot ID &quot; + slot.getId() + &quot; is available: &quot; + !isAvailable + &quot; (occupied by consultation)&quot;);&#10;            System.out.println();&#10;&#10;            System.out.println(&quot;==============================================&quot;);&#10;            System.out.println(&quot;All Repository Tests Completed Successfully!&quot;);&#10;            System.out.println(&quot;==============================================&quot;);&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;\n❌ ERROR: &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            if (transaction != null &amp;&amp; transaction.isActive()) {&#10;                transaction.rollback();&#10;                System.out.println(&quot;Transaction rolled back.&quot;);&#10;            }&#10;        } finally {&#10;//            if (em != null &amp;&amp; em.isOpen()) {&#10;//                em.close();&#10;//            }&#10;//            JPAConfig.closeEntityManager();&#10;//            System.out.println(&quot;\nEntityManager closed.&quot;);&#10;        }&#10;    }&#10;&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package com.youcode.digitalhospital;&#10;&#10;import com.youcode.digitalhospital.config.JPAConfig;&#10;import com.youcode.digitalhospital.model.*;&#10;import com.youcode.digitalhospital.repository.imp.*;&#10;import jakarta.persistence.EntityManager;&#10;import jakarta.persistence.EntityTransaction;&#10;import jakarta.persistence.Persistence;&#10;&#10;import java.time.LocalDate;&#10;import java.time.LocalDateTime;&#10;import java.util.List;&#10;&#10;public class Main {&#10;    public static void main(String[] args) {&#10;        System.out.println(&quot;==============================================&quot;);&#10;        System.out.println(&quot;Starting Repository Tests&quot;);&#10;        System.out.println(&quot;==============================================\n&quot;);&#10;&#10;        EntityManager em = null;&#10;        EntityTransaction transaction = null;&#10;&#10;        try {&#10;            // Initialize EntityManager&#10;            em = Persistence.createEntityManagerFactory(&quot;DigitalHospitalPU&quot;).createEntityManager();&#10;            System.out.println(em);&#10;            transaction = em.getTransaction();&#10;            transaction.begin();&#10;&#10;            // Initialize repositories&#10;            DepartmentRepositoryImp departmentRepo = new DepartmentRepositoryImp();&#10;            DoctorRepositoryImp doctorRepo = new DoctorRepositoryImp();&#10;            PatientRepositoryImp patientRepo = new PatientRepositoryImp();&#10;            RoomRepositoryImp roomRepo = new RoomRepositoryImp();&#10;            ConsultationSlotRepositoryImp slotRepo = new ConsultationSlotRepositoryImp();&#10;            ConsultationRepositoryImp consultationRepo = new ConsultationRepositoryImp();&#10;&#10;            // ==================== TEST 1: Department ==================== //&#10;            System.out.println(&quot;TEST 1: Creating Department...&quot;);&#10;            Department department = new Department();&#10;            department.setName(&quot;Cardiology&quot;);&#10;            department.setDescription(&quot;Heart and cardiovascular department&quot;);&#10;            em.persist(department);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Department created with ID: &quot; + department.getId());&#10;            System.out.println();&#10;&#10;            // ==================== TEST 2: Doctor ==================== //&#10;            System.out.println(&quot;TEST 2: Creating Doctor...&quot;);&#10;            Doctor doctor = new Doctor();&#10;            doctor.setFirstName(&quot;John&quot;);&#10;            doctor.setLastName(&quot;Smith&quot;);&#10;            doctor.setEmail(&quot;john.smith@hospital.com&quot;);&#10;            doctor.setPassword(&quot;password123&quot;);&#10;            doctor.setSpeciality(&quot;Cardiologist&quot;);&#10;            doctor.setDepartment(department);&#10;            em.persist(doctor);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Doctor created with ID: &quot; + doctor.getId());&#10;            System.out.println(&quot;  Name: &quot; + doctor.getUserName());&#10;            System.out.println(&quot;  Specialty: &quot; + doctor.getSpecialty());&#10;            System.out.println();&#10;&#10;            // ==================== TEST 3: Patient ==================== //&#10;            System.out.println(&quot;TEST 3: Creating Patient...&quot;);&#10;            Patient patient = new Patient();&#10;            patient.setFirstName(&quot;Jane&quot;);&#10;            patient.setLastName(&quot;Doe&quot;);&#10;            patient.setEmail(&quot;jane.doe@email.com&quot;);&#10;            patient.setPassword(&quot;patient123&quot;);&#10;            patient.setWeight(65.5);&#10;            patient.setHeight(165.0);&#10;            patient.setDateOfBirth(LocalDate.of(1990, 5, 15));&#10;            patient.setPhoneNumber(&quot;0612345678&quot;);&#10;            em.persist(patient);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Patient created with ID: &quot; + patient.getId());&#10;            System.out.println(&quot;  Name: &quot; + patient.getUserName());&#10;            System.out.println(&quot;  Weight: &quot; + patient.getWeight() + &quot; kg&quot;);&#10;            System.out.println(&quot;  Height: &quot; + patient.getHeight() + &quot; cm&quot;);&#10;            System.out.println();&#10;&#10;            // ==================== TEST 4: Room ==================== //&#10;            System.out.println(&quot;TEST 4: Creating Room...&quot;);&#10;            Room room = new Room();&#10;            room.setRoomNumber(101L);&#10;            room.setAvailable(true);&#10;            em.persist(room);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Room created with ID: &quot; + room.getId());&#10;            System.out.println(&quot;  Room Number: &quot; + room.getRoomNumber());&#10;            System.out.println(&quot;  Available: &quot; + room.isAvailable());&#10;            System.out.println();&#10;&#10;            // ==================== TEST 5: Consultation Slot ==================== //&#10;            System.out.println(&quot;TEST 5: Creating Consultation Slot...&quot;);&#10;            ConsultationSlot slot = new ConsultationSlot();&#10;            slot.setStartTime(LocalDateTime.now().plusDays(1).withHour(10).withMinute(0));&#10;            slot.setEndTime(LocalDateTime.now().plusDays(1).withHour(10).withMinute(30));&#10;            slot.setRoom(room);&#10;            slot.setCancelled(false);&#10;            em.persist(slot);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Consultation Slot created with ID: &quot; + slot.getId());&#10;            System.out.println(&quot;  Start Time: &quot; + slot.getStartTime());&#10;            System.out.println(&quot;  End Time: &quot; + slot.getEndTime());&#10;            System.out.println();&#10;&#10;            // ==================== TEST 6: Consultation ==================== //&#10;            System.out.println(&quot;TEST 6: Creating Consultation...&quot;);&#10;            Consultation consultation = new Consultation();&#10;            consultation.setPatient(patient);&#10;            consultation.setDoctor(doctor);&#10;            consultation.setSlot(slot);&#10;            consultation.setConsultationDate(LocalDate.now().plusDays(1));&#10;            consultation.setConsultationTime(slot.getStartTime());&#10;            consultation.setReason(&quot;Regular checkup&quot;);&#10;            consultation.setConsultationStatus(ConsultationStatus.RESERVED);&#10;            em.persist(consultation);&#10;            em.flush();&#10;            System.out.println(&quot;✓ Consultation created with ID: &quot; + consultation.getId());&#10;            System.out.println(&quot;  Patient: &quot; + patient.getUserName());&#10;            System.out.println(&quot;  Doctor: &quot; + doctor.getUserName());&#10;            System.out.println(&quot;  Status: &quot; + consultation.getConsultationStatus());&#10;            System.out.println();&#10;&#10;            transaction.commit();&#10;            System.out.println(&quot;✓ All entities persisted successfully!\n&quot;);&#10;&#10;            // ==================== TEST 7: Repository Queries ==================== //&#10;            System.out.println(&quot;==============================================&quot;);&#10;            System.out.println(&quot;Testing Repository Query Methods&quot;);&#10;            System.out.println(&quot;==============================================\n&quot;);&#10;&#10;            // Test Department Repository&#10;            System.out.println(&quot;TEST 7.1: Finding Department by Name...&quot;);&#10;            Department foundDept = departmentRepo.findByName(&quot;Cardiology&quot;, em).orElse(null);&#10;            if (foundDept != null) {&#10;                System.out.println(&quot;✓ Found Department: &quot; + foundDept.getName());&#10;            }&#10;            System.out.println();&#10;&#10;            // Test Doctor Repository&#10;            System.out.println(&quot;TEST 7.2: Finding Doctors by Specialty...&quot;);&#10;            List&lt;Doctor&gt; cardiologists = doctorRepo.findBySpecialty(&quot;Cardiologist&quot;, em);&#10;            System.out.println(&quot;✓ Found &quot; + cardiologists.size() + &quot; Cardiologist(s)&quot;);&#10;            System.out.println();&#10;&#10;            // Test Patient Repository&#10;            System.out.println(&quot;TEST 7.3: Finding Patient by Email...&quot;);&#10;            Patient foundPatient = patientRepo.findByEmail(&quot;jane.doe@email.com&quot;, em);&#10;            if (foundPatient != null) {&#10;                System.out.println(&quot;✓ Found Patient: &quot; + foundPatient.getUserName());&#10;            }&#10;            System.out.println();&#10;&#10;            // Test Room Repository&#10;            System.out.println(&quot;TEST 7.4: Finding Available Rooms...&quot;);&#10;            List&lt;Room&gt; availableRooms = roomRepo.findAvailableRooms(em);&#10;            System.out.println(&quot;✓ Found &quot; + availableRooms.size() + &quot; available room(s)&quot;);&#10;            System.out.println();&#10;&#10;            // Test Slot Repository&#10;            System.out.println(&quot;TEST 7.5: Finding Available Slots...&quot;);&#10;            List&lt;ConsultationSlot&gt; availableSlots = slotRepo.findAvailableSlots(em);&#10;            System.out.println(&quot;✓ Found &quot; + availableSlots.size() + &quot; available slot(s)&quot;);&#10;            System.out.println();&#10;&#10;            // Test Consultation Repository&#10;            System.out.println(&quot;TEST 7.6: Finding Consultations by Patient...&quot;);&#10;            List&lt;Consultation&gt; patientConsultations = consultationRepo.findByPatient(patient, em);&#10;            System.out.println(&quot;✓ Found &quot; + patientConsultations.size() + &quot; consultation(s) for patient&quot;);&#10;            System.out.println();&#10;&#10;            System.out.println(&quot;TEST 7.7: Counting Consultations by Status...&quot;);&#10;            Long reservedCount = consultationRepo.countByStatus(ConsultationStatus.RESERVED, em);&#10;            System.out.println(&quot;✓ Total RESERVED consultations: &quot; + reservedCount);&#10;            System.out.println();&#10;&#10;            // Test Slot Availability&#10;            System.out.println(&quot;TEST 7.8: Checking Slot Availability...&quot;);&#10;            boolean isAvailable = slotRepo.isSlotAvailable(slot.getId(), em);&#10;            System.out.println(&quot;✓ Slot ID &quot; + slot.getId() + &quot; is available: &quot; + !isAvailable + &quot; (occupied by consultation)&quot;);&#10;            System.out.println();&#10;&#10;            System.out.println(&quot;==============================================&quot;);&#10;            System.out.println(&quot;All Repository Tests Completed Successfully!&quot;);&#10;            System.out.println(&quot;==============================================&quot;);&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;\n❌ ERROR: &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            if (transaction != null &amp;&amp; transaction.isActive()) {&#10;                transaction.rollback();&#10;                System.out.println(&quot;Transaction rolled back.&quot;);&#10;            }&#10;        } finally {&#10;//            if (em != null &amp;&amp; em.isOpen()) {&#10;//                em.close();&#10;//            }&#10;//            JPAConfig.closeEntityManager();&#10;//            System.out.println(&quot;\nEntityManager closed.&quot;);&#10;        }&#10;    }&#10;&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/youcode/digitalhospital/repository/imp/DepartmentRepositoryImp.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/youcode/digitalhospital/repository/imp/DepartmentRepositoryImp.java" />
              <option name="originalContent" value="package com.youcode.digitalhospital.repository.imp;&#10;&#10;import com.youcode.digitalhospital.model.Department;&#10;import com.youcode.digitalhospital.repository.interfaces.IDepartmentRepository;&#10;import jakarta.persistence.EntityManager;&#10;&#10;import java.util.List;&#10;import java.util.Optional;&#10;&#10;public class DepartmentRepositoryImp extends GenericRepositoryImp implements IDepartmentRepository {&#10;    public DepartmentRepositoryImp() {&#10;        super(Department.class);&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Department&gt; findByNameContaining(String namePattern, EntityManager em) {&#10;        String jpql = &quot;SELECT d FROM Department d WHERE d.name LIKE :name&quot;;&#10;        return em.createQuery(jpql, Department.class)&#10;                .setParameter(&quot;name&quot;, &quot;%&quot; + namePattern + &quot;%&quot;)&#10;                .getResultList();&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Department&gt; findDepartmentsWithDoctors(EntityManager em) {&#10;        String jpql = &quot;SELECT DISTINCT d FROM Department d LEFT JOIN FETCH d.doctors&quot;;&#10;        return em.createQuery(jpql, Department.class)&#10;                .getResultList();&#10;    }&#10;&#10;    @Override&#10;    public Department findByName(String name, EntityManager em) {&#10;        try {&#10;            String jpql = &quot;SELECT d FROM Department d WHERE d.name = :name&quot;;&#10;            return em.createQuery(jpql, Department.class)&#10;                    .setParameter(&quot;name&quot;, name)&#10;                    .getSingleResult();&#10;        } catch (Exception e) {&#10;            return null;&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public boolean existsByName(String name, EntityManager em) {&#10;        String jpql = &quot;SELECT COUNT(d) FROM Department d WHERE d.name = :name&quot;;&#10;        Long count = em.createQuery(jpql, Long.class)&#10;                .setParameter(&quot;name&quot;, name)&#10;                .getSingleResult();&#10;        return count &gt; 0;&#10;    }&#10;&#10;    @Override&#10;    public Long countAllDepartments(EntityManager em) {&#10;        String jpql = &quot;SELECT COUNT(d) FROM Department d&quot;;&#10;        return em.createQuery(jpql, Long.class)&#10;                .getSingleResult();&#10;    }&#10;&#10;    @Override&#10;    public Optional&lt;Department&gt; findByIdWithDoctors(Long departmentId, EntityManager em) {&#10;        try {&#10;            String jpql = &quot;SELECT d FROM Department d LEFT JOIN FETCH d.doctors WHERE d.id = :id&quot;;&#10;            Department department = em.createQuery(jpql, Department.class)&#10;                    .setParameter(&quot;id&quot;, departmentId)&#10;                    .getSingleResult();&#10;            return Optional.ofNullable(department);&#10;        } catch (Exception e) {&#10;            return Optional.empty();&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.youcode.digitalhospital.repository.imp;&#10;&#10;import com.youcode.digitalhospital.model.Department;&#10;import com.youcode.digitalhospital.repository.interfaces.IDepartmentRepository;&#10;import jakarta.persistence.EntityManager;&#10;&#10;import java.util.List;&#10;import java.util.Optional;&#10;&#10;public class DepartmentRepositoryImp extends GenericRepositoryImp implements IDepartmentRepository {&#10;    public DepartmentRepositoryImp() {&#10;        super(Department.class);&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Department&gt; findByNameContaining(String namePattern, EntityManager em) {&#10;        String jpql = &quot;SELECT d FROM Department d WHERE d.name LIKE :name&quot;;&#10;        return em.createQuery(jpql, Department.class)&#10;                .setParameter(&quot;name&quot;, &quot;%&quot; + namePattern + &quot;%&quot;)&#10;                .getResultList();&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Department&gt; findDepartmentsWithDoctors(EntityManager em) {&#10;        String jpql = &quot;SELECT DISTINCT d FROM Department d LEFT JOIN FETCH d.doctors&quot;;&#10;        return em.createQuery(jpql, Department.class)&#10;                .getResultList();&#10;    }&#10;&#10;    @Override&#10;    public Department findByName(String name, EntityManager em) {&#10;        try {&#10;            String jpql = &quot;SELECT d FROM Department d WHERE d.name = :name&quot;;&#10;            return em.createQuery(jpql, Department.class)&#10;                    .setParameter(&quot;name&quot;, name)&#10;                    .getSingleResult();&#10;        } catch (Exception e) {&#10;            return null;&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public boolean existsByName(String name, EntityManager em) {&#10;        String jpql = &quot;SELECT COUNT(d) FROM Department d WHERE d.name = :name&quot;;&#10;        Long count = em.createQuery(jpql, Long.class)&#10;                .setParameter(&quot;name&quot;, name)&#10;                .getSingleResult();&#10;        return count &gt; 0;&#10;    }&#10;&#10;    @Override&#10;    public Long countAllDepartments(EntityManager em) {&#10;        String jpql = &quot;SELECT COUNT(d) FROM Department d&quot;;&#10;        return em.createQuery(jpql, Long.class)&#10;                .getSingleResult();&#10;    }&#10;&#10;    @Override&#10;    public Optional&lt;Department&gt; findByIdWithDoctors(Long departmentId, EntityManager em) {&#10;        try {&#10;            String jpql = &quot;SELECT d FROM Department d LEFT JOIN FETCH d.doctors WHERE d.id = :id&quot;;&#10;            Department department = em.createQuery(jpql, Department.class)&#10;                    .setParameter(&quot;id&quot;, departmentId)&#10;                    .getSingleResult();&#10;            return Optional.ofNullable(department);&#10;        } catch (Exception e) {&#10;            return Optional.empty();&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>